<?php

namespace Security\CodeAnalyzer\Vulnerability;

/**
 * Represents a Command Injection vulnerability.
 */
class CommandInjectionVulnerability extends AbstractVulnerability
{
    /**
     * {@inheritdoc}
     */
    public function getType(): string
    {
        return 'Command Injection';
    }

    /**
     * {@inheritdoc}
     */
    public function getDescription(): string
    {
        return 'Command Injection vulnerability detected. User input is directly used in system commands without proper validation, ' .
               'which could allow attackers to execute arbitrary commands on the server.';
    }

    /**
     * {@inheritdoc}
     */
    public function getSuggestion(): string
    {
        return 'Avoid using functions like exec(), system(), shell_exec(), or passthru() with user input. ' .
               'If you must use these functions, strictly validate and sanitize the input. ' .
               'For example, replace: ' .
               'system("ping " . $userInput); ' .
               'with a safer alternative like: ' .
               '$userInput = escapeshellarg($userInput); ' .
               'system("ping " . $userInput); ' .
               'Better yet, use a specific PHP function or library that provides the functionality you need without shell commands.';
    }
}
