<?php

namespace Security\CodeAnalyzer\Vulnerability;

/**
 * Represents a Cross-Site Scripting (XSS) vulnerability.
 */
class XSSVulnerability extends AbstractVulnerability
{
    /**
     * {@inheritdoc}
     */
    public function getType(): string
    {
        return 'Cross-Site Scripting (XSS)';
    }

    /**
     * {@inheritdoc}
     */
    public function getDescription(): string
    {
        return 'Cross-Site Scripting (XSS) vulnerability detected. User input is directly output to HTML without proper escaping, ' .
               'which could allow attackers to inject malicious scripts that execute in users\' browsers.';
    }

    /**
     * {@inheritdoc}
     */
    public function getSuggestion(): string
    {
        return 'Always escape output when displaying user input in HTML context. ' .
               'For example, replace: ' .
               'echo $userInput; ' .
               'with: ' .
               'echo htmlspecialchars($userInput, ENT_QUOTES, \'UTF-8\'); ' .
               'Consider using a template engine with auto-escaping or a framework that handles output escaping automatically.';
    }
}
